<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <title>マイトアンドマジック (FC) 攻略&#x2F;解析 -お宝 -お宝概要</title>

    <link rel="stylesheet" href="https://taotao54321.github.io/MightAndMagicJResource/css/main.css">
</head>
<body><header><a href="https://taotao54321.github.io/MightAndMagicJResource/">マイトアンドマジック (FC) 攻略&#x2F;解析</a>
            
                - 
            <a href="https://taotao54321.github.io/MightAndMagicJResource/treasure/">お宝</a>
            
            </header>

    <h1>お宝概要</h1>

    <h2 id="obao-nogou-cheng-yao-su">お宝の構成要素</h2>
<p>お宝は以下の構成要素からなる:</p>
<ul>
<li>罠</li>
<li>ランク</li>
<li>GOLD</li>
<li>GEM</li>
<li>アイテム (最大 3 個)</li>
</ul>
<p>お宝内にGOLD, GEM, アイテムのいずれかが存在するときに探索メニューコマンド「さがす」を実行するとお宝メニューへ遷移する。</p>
<h3 id="min">罠</h3>
<p>お宝内の罠は未確定、罠なし、罠ありのいずれかの状態をとる。</p>
<p>罠が未確定の場合、「さがす」でお宝シーンへ遷移した際に罠確定処理が行われる。<code>rand(1..=100) &lt; (現在のマップの罠頻度)</code> なら罠あり、さもなくば罠なしとなる。</p>
<p>戦闘勝利によりお宝が更新される場合、罠は未確定となる。
イベントによりお宝が設定される場合、罠の設定はイベントごとに異なる。</p>
<h3 id="ranku">ランク</h3>
<p>お宝ランクは <code>0..=10</code> の値で、お宝の外観および罠にかかった際のダメージに影響する。</p>
<p>お宝のランクと外観の対応は以下の通り:</p>
<ul>
<li>ランク <code>0..=1</code> ならば革袋。</li>
<li>ランク <code>2..=4</code> ならば青宝箱。</li>
<li>ランク <code>5..=7</code> ならば緑宝箱。</li>
<li>ランク <code>8..=10</code> ならば金宝箱。</li>
</ul>
<p>戦闘勝利によりお宝が更新される場合、お宝ランクは中身に見合った値となる。
イベントによりお宝が設定される場合、お宝ランクはイベントごとに異なる。</p>
<h3 id="gold">GOLD</h3>
<p>お宝内のGOLDは <code>u16</code> 値で、加算時のオーバーフローは無視される。</p>
<h3 id="gem">GEM</h3>
<p>お宝内のGEMは <code>u8</code> 値で、加算時のオーバーフローは無視される。</p>
<h3 id="aitemu">アイテム</h3>
<p>お宝内のアイテムは最大 3 個。満杯の場合、アイテムはそれ以上追加されない。</p>
<h2 id="obao-nogeng-xin">お宝の更新</h2>
<p>お宝は以下のケースで更新される:</p>
<ul>
<li>戦闘勝利時、倒した敵たちに応じてGOLD, GEM, アイテムが追加される。上書きされるのではないことに注意。
つまり、同じマスで連続して戦闘勝利すればお宝の内容は累積する。</li>
<li>特定のイベントによりGOLD/GEM/アイテムが設定される。</li>
<li>お宝を開けてGOLD/GEM/アイテムを取得した際、取得したものが消える。</li>
<li>戦闘中に「にげる」コマンドや魔ML4「離脱」で逃げた場合、お宝の内容が全てクリアされる。</li>
<li>PTが「歩いた」とみなされた場合、お宝の内容が全てクリアされる。以下のケースが該当する:
<ul>
<li>探索シーンで前進移動が成功したとき(マップ端をまたいだかどうかによらず)</li>
<li>探索シーンで後退移動が成功したとき(マップ端をまたごうとして座標が clamp された場合も含む)</li>
<li>マップIDを指定したワープ処理が発動したとき。以下のケースが該当する:
<ul>
<li>僧ML4「浮上」成功時</li>
<li>僧ML6「町へ」成功時</li>
<li>魔ML5「テレポート」成功時</li>
<li>魔ML7「アストラル」成功時</li>
<li>戦闘前フェイズの「にげる」成功時</li>
<li>イベントによるマップID指定ワープ発動時</li>
</ul>
</li>
<li>魔ML6「通過」による移動が成功したとき</li>
<li>レイバン砦地下2のベルトコンベアにより移動させられたとき</li>
<li>ドラガデューン地下2 (4, 5) に進入して地面が揺れたとき</li>
<li>魔法の砦地下2 (6, 4), (7, 4), (8, 4), (9, 4) のいずれかに進入してランダム移動させられたとき</li>
</ul>
</li>
</ul>
<p>お宝は以下のケースでは更新<strong>されない</strong>:</p>
<ul>
<li>お宝メニューで「あきらめる」またはキャンセルを選んだ場合(その場から動かず再度「さがす」を行えば取り直せる)</li>
<li>お宝内のアイテムを取得中にPTのバックパックが満杯になって中断した場合(同様に取り直せる)</li>
<li>魔ML2「ジャンプ」による移動</li>
<li><a href="https://taotao54321.github.io/MightAndMagicJResource/encounter/pre-battle/">戦闘前フェイズ</a>の「おくりもの」成功時</li>
<li><a href="https://taotao54321.github.io/MightAndMagicJResource/encounter/pre-battle/">戦闘前フェイズ</a>の「こうさん」成功時(降参ワープの有無を問わず)</li>
</ul>
</body>
</html>
