+++
title = "RAM マップ"
+++

## 概要

| アドレス | 型 | 内容 |
| -- | -- | -- |
| `$00-$05` | | 雑用 |
| `$06-$07` | | (未使用) |
| `$08-$09` | | {% todo() %}TODO{% end %} |
| `$0A` | `u8[0x70]` | [味方キャラ構造体](@/data-structure/hero/_index.md)操作用バッファ |
| `$7A` | | (未使用) |
| `$7B` | | 雑用 |
| `$7C` | | オーディオドライバ関連 |
| `$7D` | | オーディオドライバ関連 |
| `$7E` | `u8` | 音楽の再生制御用 |
| `$7F` | `u8` | 音楽ID |
| `$80-` | | オーディオドライバ関連 |
| `$8B-$9C` | `u8[18]` | PTバフ配列 |
| `$8B-$91` | `u8[7]` | PTバフ: 各種耐性 |
| `$8B` | `u8` | PTバフ: 恐怖耐性 |
| `$8C` | `u8` | PTバフ: 冷気耐性 |
| `$8D` | `u8` | PTバフ: 火耐性 |
| `$8E` | `u8` | PTバフ: 毒耐性 |
| `$8F` | `u8` | PTバフ: 酸耐性 |
| `$90` | `u8` | PTバフ: 電撃耐性 |
| `$91` | `u8` | PTバフ: 魔法耐性 |
| `$92` | `u8` | PTバフ: 光源値 |
| `$93` | `u8` | PTバフ: 「バリア」(0:false, 非0:true) |
| `$94` | `u8` | PTバフ: 「予知能力」(0:false, 非0:true) |
| `$95` | `u8` | PTバフ: 「水上歩行」(0:false, 非0:true) |
| `$96` | `u8` | PTバフ: 「幻の犬」(0:false, 非0:true) |
| `$97` | `u8` | PTバフ: 「精神防御」(0:false, 非0:true) |
| `$98` | `u8` | PTバフ: 「神の祝福」(0:false, 非0:true) |
| `$99` | `u8` | PTバフ: 「透明フィールド」(0:false, 非0:true) |
| `$9A` | `u8` | PTバフ: 「空中シールド」(0:false, 非0:true) |
| `$9B` | `u8` | PTバフ: 「パワーシールド」(0:false, 非0:true) |
| `$9C` | `u8` | PTバフ: 「呪いの消去」<br>{% xxx() %}実質デバフ{% end %} |
| `$9D` | `u8` | 予約イベント |
| `$9E` | `u8` | 現在の[マップID](@/map/_index.md) |
| `$9F` | `u8` | 現在のマップ内座標x (`0..=15`) |
| `$A0` | `u8` | 現在のマップ内座標y (`0..=15`) |
| `$A1` | `u8` | 現在のマップ内座標を `u8` に pack した値 (bit0-3:座標x, bit4-7:座標y) |
| `$A2` | `u8` | 現在のPTの向きに対して前方の[方角](#direction) |
| `$A3` | `u8` | 現在のPTの向きに対して右の[方角](#direction) |
| `$A4` | `u8` | 現在のPTの向きに対して後方の[方角](#direction) |
| `$A5` | `u8` | 現在のPTの向きに対して左の[方角](#direction) |
| `$A6` | `u8` | PTの人数 (`1..=6`) |
| `$A7-$AC` | `u8` | 各PTキャラの[味方キャラID](@/hero/_index.md#table) (隊列順) |
| `$AD` | `u8` | お宝関連 |
| `$AE` | `u8` | お宝関連 |
| `$AF-$B4` | `u8[6]` | お宝の中身 |
| `$AF-$B1` | `u8[3]` | お宝の中身のアイテムID配列 |
| `$B2` | `u16le` | お宝の中身のGOLD |
| `$B4` | `u8` | お宝の中身のGEM |
| `$B5` | `u8` | 戦闘: 生きている敵の個体数 (`0..=15`) |
| `$B6-$C4` | `u8[15]` | 戦闘: 各敵キャラのモンスターランク |
| `$C5-$D3` | `u8[15]` | 戦闘: 各敵キャラのモンスターランク内ID |
| `$D4` | `u8` | 戦闘: 敵軍の「強さ」 |
| `$D5` | | (*write-only*) |
| `$D6-` | | オーディオドライバ関連 |
| `$E2-$E6` | | 雑用 |
| `$E7-$EE` | | イベント処理雑用 (マップを出入りするたびにゼロクリアされる) |
| `$EF-$F2` | | 雑用 |
| `$F3-` | | オーディオドライバ関連 |
| `$0100-$01FF` | | スタック領域 |
| `$0200` | `u8` | [入力](#input)処理用 |
| `$0201` | `u8` | 前回の1P生[入力](#input) (注意: 複数ルーチンで使い回されている) |
| `$0202` | `u8` | [入力](#input)処理用 |
| `$0203` | `u8` | [入力](#input)処理用 |
| `$0204` | `ptr` | 現在の IRQ ハンドラ |
| | | {% todo() %}TODO{% end %} |
| `$0244-$0245` | | 雑用 |
| | | {% todo() %}TODO{% end %} |
| `$0248-$024F` | | 雑用 |
| | | {% todo() %}TODO{% end %} |
| `$0275` | `u8` | 現在のマップがバーン地上かどうか (0:false, 1:true) |
| | | {% todo() %}TODO{% end %} |
| `$02A8-$02B2` | `u8[11]` | 現在見ているアイテムデータ |
| | | {% todo() %}TODO{% end %} |
| `$02CC-$02D0` | | 雑用 |
| `$02D1` | `u8` | 現在位置の周囲 4 方向の境界 |
| `$02D2` | `u8` | 現在位置のマスの各種フラグ |
| `$02D3` | `u8` | 現在のPTの向きに対して前方の境界 (`0..=3`) |
| `$02D4` | `u8` | 現在のPTの向きに対して前方が通行不可かどうか (0:false, 非0:true) |
| `$02D5` | `u8` | 現在のPTの向きに対して後方の境界 (`0..=3`) |
| `$02D6` | `u8` | 現在のPTの向きに対して後方が通行不可かどうか (0:false, 非0:true) |
| `$02D7` | | (*write-only*) |
| | | {% todo() %}TODO{% end %} |
| `$0305` | | 雑用 |
| | | {% todo() %}TODO{% end %} |
| `$0366` | | 雑用 |
| | | {% todo() %}TODO{% end %} |
| `$0393-$0394` | | 雑用 |
| `$0395` | `u8` | 徘徊エンカウント発生フラグ (0:false, 1:true) |
| | | {% todo() %}TODO{% end %} |
| `$039C-$039D` | | 雑用 |
| | | {% todo() %}TODO{% end %} |
| `$03A2` | | 雑用 |
| | | {% todo() %}TODO{% end %} |
| `$03C4-$03D4` | `u8[17]` | 現在見ているモンスターデータ |
| `$03D5` | | {% todo() %}TODO{% end %} |
| `$03D6` | `u16le` | 自軍の「強さ」 |
| `$03D8` | `u16le` | 主人公の「強さ」 |
| `$03DA` | `u8` | 戦闘: エンカウント直後の敵軍のモンスターランク最大値 |
| `$03DB` | | (未使用) |
| `$03DC` | `u8` | 戦闘: 敵軍の友好度 |
| `$03DD` | | (未使用) |
| `$03DE` | `u8` | 戦闘前メニューでの選択による性格変更フラグ (0:false, 1:true)<br>{% xxx() %}実質未使用{% end %} |
| `$03DF` | `u8` | 最後に追加されたランダム敵のモンスターランク<br>{% xxx() %}本来は多用途の雑用変数と思われる{% end %} |
| `$03E0-$03E3` | | 雑用 |
| `$03E4-$03E9` | `u8[6]` | 戦闘: 各味方が近接攻撃可能かどうか (0:false, 1:true) |
| `$03EA-$03EF` | `u8[6]` | 戦闘: 各味方がこのターンの行動を終えたかどうか (0:false, 1:true) |
| `$03F0-$03FE` | `u8[15]` | 戦闘: 各敵の現在HP |
| `$03FF` | | (未使用) |
| `$0400-$040E` | `u8[15]` | 戦闘: 各敵のAC |
| `$040F` | | (未使用) |
| `$0410-$041E` | `u8[15]` | 戦闘: 各敵の状態異常 |
| `$041F` | | (未使用) |
| `$0420-$042E` | `u8[15]` | {% todo() %}TODO{% end %} |
| `$042F` | | (未使用) |
| `$0430` | | 雑用 |
| `$0431` | | {% todo() %}TODO{% end %} |
| `$0432` | `u8` | 戦闘: 敵前衛の個体数 |
| | | {% todo() %}TODO{% end %} |
| `$0439` | `u8` | 戦闘: 現在の味方の行動が遠隔攻撃かどうか (0:false, 1:true) |
| | | {% todo() %}TODO{% end %} |
| `$0442` | `u8` | 戦闘: ターン数 (最初のターン開始時が 1) |
| | | {% todo() %}TODO{% end %} |
| `$044F` | `u8` | 戦闘: この戦闘で僧ML1「退散」を既に使ったか (0:false, 1:true) |
| `$0450` | `u8` | 戦闘: この戦闘で僧ML7「神の声」を既に使ったか (0:false, 1:true) |
| | | {% todo() %}TODO{% end %} |
| `$0457-$045C` | `u8[6]` | 戦闘: 各味方の素早さ |
| | | {% todo() %}TODO{% end %} |
| `$0461-$0466` | `u8[6]` | 戦闘: 各味方の状態異常 |
| | | {% todo() %}TODO{% end %} |
| `$0472-$0473` | | 雑用 |
| | | {% todo() %}TODO{% end %} |
| `$047D-$0482` | | 雑用 |
| | | {% todo() %}TODO{% end %} |
| `$04A3` | | 雑用 |
| | | {% todo() %}TODO{% end %} |
| `$050B` | `u8` | 戦闘: オート戦闘中かどうか (0:false, 1:true) |
| | | {% todo() %}TODO{% end %} |
| `$0523` | `u8[2]` | 乱数生成器の内部状態 |
| | | {% todo() %}TODO{% end %} |
| `$061A` | `u8` | 現在位置が暗闇かどうか (0:false, 1:true) |
| `$061B` | | (*write-only*) |
| `$061C` | | {% todo() %}TODO{% end %} |
| `$061D` | | 雑用 |
| `$061E` | | (未使用) |
| `$061F-$0621` | | 雑用 |
| `$0622-$0624` | | (*write-only*) |
| `$062B` | | イベント処理雑用 (マップを出入りするたびにゼロクリアされる) |
| `$062C-$062D` | | (*write-only*) (マップを出入りするたびにゼロクリアされる) |
| | | {% todo() %}TODO{% end %} |
| `$0643-$0651` | `u8[15]` | 戦闘: 各敵の素早さ |
| | | {% todo() %}TODO{% end %} |
| `$0654` | | イベント処理雑用 (マップを出入りするたびにゼロクリアされる) |
| `$0655-$0656` | | (*write-only*) (マップを出入りするたびにゼロクリアされる) |
| | | {% todo() %}TODO{% end %} |
| `$067E` | `ptr` | 現在の NMI ハンドラ |
| | | {% todo() %}TODO{% end %} |
| `$6000-$6001` | | (未使用) |
| `$6002-$6005` | `u8[4]` | SRAM が初期化済みであることを示す magic 文字列 ("NEMU") |
| `$6006-$600F` | | (未使用) |
| `$6010-$6150` | code | PPU へのデータ転送用コード (64 個の `lda #n, sta $2007` が並び、`rts` で終端) |
| `$6151` | | {% todo() %}TODO{% end %} |
| `$6152-$6154` | | {% todo() %}TODO{% end %} |
| `$6155-$6156` | | (未使用) |
| `$6157` | | {% todo() %}TODO{% end %} |
| `$6158` | | (未使用) |
| `$6159` | | {% todo() %}TODO{% end %} |
| `$615A` | | (未使用) |
| `$615B-` | | {% todo() %}TODO{% end %} |
| `$615D-$617C` | `u8[0x20]` | 現在のパレット |
| `$617D-$617F` | | (未使用) |
| `$6180-$61BF` | `u8[0x40]` | 現在のマップメタデータ(マップ名除く) |
| | | {% todo() %}TODO{% end %} |
| `$6200-$62FF` | `u8[0x100]` | 現在のマップの各マスについて周囲 4 方向の境界を保持する配列 |
| `$6300-$63FF` | `u8[0x100]` | 現在のマップの各マスについて各種フラグを保持する配列 |
| | | {% todo() %}TODO{% end %} |
| `$6430-$6463` | `u8[52]` | オートマッピング可能な全マップに対する踏破済みフラグ配列のチェックサム (XOR 総和) |
| | | {% todo() %}TODO{% end %} |
| `$6880-$689F` | `u8[32]` | 踏破済みフラグ配列: ソーピガルの町 |
| `$68A0-$68BF` | `u8[32]` | 踏破済みフラグ配列: ポートスミスの町 |
| `$68C0-$68DF` | `u8[32]` | 踏破済みフラグ配列: アルガリーの町 |
| `$68E0-$68FF` | `u8[32]` | 踏破済みフラグ配列: ダスクの町 |
| `$6900-$691F` | `u8[32]` | 踏破済みフラグ配列: エルキューンの町 |
| `$6920-$693F` | `u8[32]` | 踏破済みフラグ配列: ソーピガルの地下 |
| `$6940-$695F` | `u8[32]` | 踏破済みフラグ配列: ノーザンバリアー洞穴 |
| `$6960-$697F` | `u8[32]` | 踏破済みフラグ配列: ポートスミスの地下 |
| `$6980-$699F` | `u8[32]` | 踏破済みフラグ配列: エルキューンの地下 |
| `$69A0-$69BF` | `u8[32]` | 踏破済みフラグ配列: ダスクの地下 |
| `$69C0-$69DF` | `u8[32]` | 踏破済みフラグ配列: コリンブルッフ洞穴 |
| `$69E0-$69FF` | `u8[32]` | 踏破済みフラグ配列: ボルカノ神殿 |
| `$6A00-$6A1F` | `u8[32]` | 踏破済みフラグ配列: 鷹の目洞穴 |
| `$6A20-$6A3F` | `u8[32]` | 踏破済みフラグ配列: ホワイトウルフ洞穴 |
| | | {% todo() %}TODO{% end %} |
| `$6CC0-$6CDF` | `u8[32]` | 踏破済みフラグ配列: デュームの城 |
| `$6CE0-$6CFF` | `u8[32]` | 踏破済みフラグ配列: ホワイトウルフの城 |
| `$6D00-$6D1F` | `u8[32]` | 踏破済みフラグ配列: アラマーの城 |
| `$6D20-$6D3F` | `u8[32]` | 踏破済みフラグ配列: ブラックリッジノース |
| `$6D40-$6D5F` | `u8[32]` | 踏破済みフラグ配列: ブラックリッジサウス |
| `$6D60-$6D7F` | `u8[32]` | 踏破済みフラグ配列: ドラガデューンの城 |
| `$6D80-$6D9F` | `u8[32]` | 踏破済みフラグ配列: ドラガデューン地下1 |
| `$6DA0-$6DBF` | `u8[32]` | 踏破済みフラグ配列: ドラガデューン地下2 |
| `$6DC0-$6DDF` | `u8[32]` | 踏破済みフラグ配列: ドラガデューン地下3 |
| `$6DE0-$6DFF` | `u8[32]` | 踏破済みフラグ配列: 魔法の砦地下1 |
| `$6E00-$6E1F` | `u8[32]` | 踏破済みフラグ配列: 魔法の砦地下2 |
| `$6E20-$6E3F` | `u8[32]` | 踏破済みフラグ配列: 森のあばら屋地下1 |
| `$6E40-$6E5F` | `u8[32]` | 踏破済みフラグ配列: 森のあばら屋地下2 |
| `$6E60-$6E7F` | `u8[32]` | 踏破済みフラグ配列: レイバン砦地下1 |
| `$6E80-$6E9F` | `u8[32]` | 踏破済みフラグ配列: レイバン砦地下2 |
| `$6EA0-$6EBF` | `u8[32]` | 踏破済みフラグ配列: エルドラド地下1 |
| `$6EC0-$6EDF` | `u8[32]` | 踏破済みフラグ配列: エルドラド地下2 |
| `$6EE0-$6EFF` | `u8[32]` | 踏破済みフラグ配列: エルドラド地下3 |
| `$6F00-$6F6F` | `u8[0x70]` | 味方キャラ構造体 (ID=0) |
| `$6F70` | | (未使用) |
| `$6F71-$6F76` | `u8[6]` | 各PTキャラの[味方キャラID](@/hero/_index.md#table)のセーブ/ロード用バッファ |
| `$6F77` | `u8` | PT人数のセーブ/ロード用バッファ |
| `$6F78-$6F7E` | | (未使用) |
| `$6F7F` | `u8` | `$6F00-$6F7E` のチェックサム |
| `$6F80-$6FEF` | `u8[0x70]` | 味方キャラ構造体 (ID=1) |
| `$6FF0-$6FFE` | | (未使用) |
| `$6FFF` | `u8` | `$6F80-$6FFE` のチェックサム |
| `$7000-$706F` | `u8[0x70]` | 味方キャラ構造体 (ID=2) |
| `$7070-$707E` | | (未使用) |
| `$707F` | `u8` | `$7000-$707E` のチェックサム |
| `$7080-$70EF` | `u8[0x70]` | 味方キャラ構造体 (ID=3) |
| `$70F0-$70FE` | | (未使用) |
| `$70FF` | `u8` | `$7080-$70FE` のチェックサム |
| `$7100-$716F` | `u8[0x70]` | 味方キャラ構造体 (ID=4) |
| `$7170-$717E` | | (未使用) |
| `$717F` | `u8` | `$7100-$717E` のチェックサム |
| `$7180-$71EF` | `u8[0x70]` | 味方キャラ構造体 (ID=5) |
| `$71F0-$71FE` | | (未使用) |
| `$71FF` | `u8` | `$7180-$71FE` のチェックサム |
| `$7200-$726F` | `u8[0x70]` | 味方キャラ構造体 (ID=6) |
| `$7270-$727E` | | (未使用) |
| `$727F` | `u8` | `$7200-$727E` のチェックサム |
| `$7280-$72EF` | `u8[0x70]` | 味方キャラ構造体 (ID=7) |
| `$72F0-$72FE` | | (未使用) |
| `$72FF` | `u8` | `$7280-$72FE` のチェックサム |
| `$7300-$736F` | `u8[0x70]` | 味方キャラ構造体 (ID=8) |
| `$7370-$737E` | | (未使用) |
| `$737F` | `u8` | `$7300-$737E` のチェックサム |
| `$7380-$73EF` | `u8[0x70]` | 味方キャラ構造体 (ID=9) |
| `$73F0-$73FE` | | (未使用) |
| `$73FF` | `u8` | `$7380-$73FE` のチェックサム |
| `$7400-$746F` | `u8[0x70]` | 味方キャラ構造体 (ID=10) |
| `$7470-$747E` | | (未使用) |
| `$747F` | `u8` | `$7400-$747E` のチェックサム |
| `$7480-$74EF` | `u8[0x70]` | 味方キャラ構造体 (ID=11) |
| `$74F0-$74FE` | | (未使用) |
| `$74FF` | `u8` | `$7480-$74FE` のチェックサム |
| `$7500-$756F` | `u8[0x70]` | 味方キャラ構造体 (ID=12) |
| `$7570-$757E` | | (未使用) |
| `$757F` | `u8` | `$7500-$757E` のチェックサム |
| `$7580-$75EF` | `u8[0x70]` | 味方キャラ構造体 (ID=13) |
| `$75F0-$75FE` | | (未使用) |
| `$75FF` | `u8` | `$7580-$75FE` のチェックサム |
| `$7600-$766F` | `u8[0x70]` | 味方キャラ構造体 (ID=14) |
| `$7670-$767E` | | (未使用) |
| `$767F` | `u8` | `$7600-$767E` のチェックサム |
| `$7680-$76EF` | `u8[0x70]` | 味方キャラ構造体 (ID=15) |
| `$76F0-$76FE` | | (未使用) |
| `$76FF` | `u8` | `$7680-$76FE` のチェックサム |
| `$7700-$7EFF` | `u8[0x800]` | セーブデータ (`$6F00-$76FF` のコピー) |
| `$7F00-$7FFF` | `u8[16][16]` | 各味方キャラの名前 |

## 詳細

### 入力 {#input}

ABSTUDLR 形式 (bit0:R, bit1:L, ..., bit7:A)。

### 方角 {#direction}

| 値 | 意味 |
| -- | -- |
| 0 | 北 |
| 1 | 東 |
| 2 | 南 |
| 3 | 西 |



